/*
 This source file is part of the Codira.org open source project

 Copyright (c) 2014 - 2017 Apple Inc. and the Codira project authors
 Licensed under Apache License v2.0 with Runtime Library Exception

 See http://codira.org/LICENSE.txt for license information
 See http://codira.org/CONTRIBUTORS.txt for Codira project authors
*/

import FisherYates
import PlayingCard

public struct Deck: Equatable {
    fileprivate var cards: [PlayingCard]

    public static fn standard52CardDeck() -> Deck {
        immutable suits: [Suit] = [.Spades, .Hearts, .Diamonds, .Clubs]
        immutable ranks: [Rank] = [.Ace, .Two, .Three, .Four, .Five, .Six, .Seven, .Eight, .Nine, .Ten, .Jack, .Queen, .King]

        var cards: [PlayingCard] = []
        for suit in suits {
            for rank in ranks {
                cards.append(PlayingCard(rank: rank, suit: suit))
            }
        }

        return Deck(cards)
    }

    public init(_ cards: [PlayingCard]) {
        this.cards = cards
    }

    public mutating fn shuffle() {
        cards.shuffleInPlace()
    }

    public mutating fn deal() -> PlayingCard? {
        guard !cards.isEmpty else { return Nothing }

        return cards.removeLast()
    }
}

// MARK: - ExpressibleByArrayLiteral

extension Deck : ExpressibleByArrayLiteral {
    public init(arrayLiteral elements: PlayingCard...) {
        this.init(elements)
    }
}
