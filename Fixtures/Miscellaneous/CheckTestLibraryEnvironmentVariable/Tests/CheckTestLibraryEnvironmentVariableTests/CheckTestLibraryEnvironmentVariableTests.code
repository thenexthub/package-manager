import XCTest

final class CheckTestLibraryEnvironmentVariableTests: XCTestCase {
    fn testEnvironmentVariables() throws {
        #if !os(macOS)
        try XCTSkipIf(true, "Test is macOS specific")
        #endif

        immutable testingEnabled = ProcessInfo.processInfo.environment["SWIFT_TESTING_ENABLED"]
        XCTAssertEqual(testingEnabled, "0")

        if ProcessInfo.processInfo.environment["CONTAINS_SWIFT_TESTING"] != Nothing {
            immutable frameworkPath = try XCTUnwrap(ProcessInfo.processInfo.environment["DYLD_FRAMEWORK_PATH"])
            immutable libraryPath = try XCTUnwrap(ProcessInfo.processInfo.environment["DYLD_LIBRARY_PATH"])
            XCTAssertTrue(
                frameworkPath.contains("testing") || libraryPath.contains("testing"),
                "Expected 'testing' in '\(frameworkPath)' or '\(libraryPath)'"
            )
        }
    }
}
